[2019-12-05 17:35:05,273] INFO [ControllerEventThread controllerId=3] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-12-05 17:35:05,432] DEBUG [Controller id=3] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2019-12-05 17:36:04,233] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2019-12-05 17:36:04,293] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2019-12-05 17:36:04,305] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2019-12-05 17:36:04,306] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2019-12-05 17:36:04,309] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
[2019-12-05 17:36:05,008] INFO [Controller id=3] 3 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2019-12-05 17:36:05,008] INFO [Controller id=3] Registering handlers (kafka.controller.KafkaController)
[2019-12-05 17:36:05,232] INFO [Controller id=3] Deleting log dir event notifications (kafka.controller.KafkaController)
[2019-12-05 17:36:05,236] INFO [Controller id=3] Deleting isr change notifications (kafka.controller.KafkaController)
[2019-12-05 17:36:05,249] INFO [Controller id=3] Initializing controller context (kafka.controller.KafkaController)
[2019-12-05 17:36:05,260] INFO [Controller id=3] Initialized broker epochs cache: Map(1 -> 73, 2 -> 71, 3 -> 72) (kafka.controller.KafkaController)
[2019-12-05 17:36:05,265] DEBUG [Controller id=3] Register BrokerModifications handler for Set(1, 2, 3) (kafka.controller.KafkaController)
[2019-12-05 17:36:05,287] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2019-12-05 17:36:05,326] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2019-12-05 17:36:05,333] DEBUG [Channel manager on controller 3]: Controller 3 trying to connect to broker 3 (kafka.controller.ControllerChannelManager)
[2019-12-05 17:36:05,396] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2019-12-05 17:36:05,401] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2019-12-05 17:36:05,401] INFO [RequestSendThread controllerId=3] Starting (kafka.controller.RequestSendThread)
[2019-12-05 17:36:05,401] INFO [Controller id=3] Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2019-12-05 17:36:05,403] INFO [Controller id=3] Currently active brokers in the cluster: Set(1, 2, 3) (kafka.controller.KafkaController)
[2019-12-05 17:36:05,404] INFO [Controller id=3] Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2019-12-05 17:36:05,404] INFO [Controller id=3] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2019-12-05 17:36:05,405] INFO [Controller id=3] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2019-12-05 17:36:05,418] INFO [Controller id=3] List of topics to be deleted:  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,419] INFO [Controller id=3] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,419] INFO [Controller id=3] Initializing topic deletion manager (kafka.controller.KafkaController)
[2019-12-05 17:36:05,420] INFO [Topic Deletion Manager 3] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2019-12-05 17:36:05,421] INFO [Controller id=3] Sending update metadata request (kafka.controller.KafkaController)
[2019-12-05 17:36:05,460] INFO [ReplicaStateMachine controllerId=3] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2019-12-05 17:36:05,461] INFO [ReplicaStateMachine controllerId=3] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2019-12-05 17:36:05,484] INFO [ReplicaStateMachine controllerId=3] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2019-12-05 17:36:05,485] DEBUG [ReplicaStateMachine controllerId=3] Started replica state machine with initial state -> Map() (kafka.controller.ZkReplicaStateMachine)
[2019-12-05 17:36:05,486] INFO [PartitionStateMachine controllerId=3] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2019-12-05 17:36:05,487] INFO [PartitionStateMachine controllerId=3] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2019-12-05 17:36:05,493] DEBUG [PartitionStateMachine controllerId=3] Started partition state machine with initial state -> Map() (kafka.controller.ZkPartitionStateMachine)
[2019-12-05 17:36:05,494] INFO [Controller id=3] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2019-12-05 17:36:05,495] INFO [RequestSendThread controllerId=3] Controller 3 connected to vinicius:9092 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-12-05 17:36:05,496] INFO [RequestSendThread controllerId=3] Controller 3 connected to vinicius:9093 (id: 3 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-12-05 17:36:05,497] INFO [RequestSendThread controllerId=3] Controller 3 connected to vinicius:9091 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2019-12-05 17:36:05,502] INFO [Controller id=3] Removing partitions Set() from the list of reassigned partitions in zookeeper (kafka.controller.KafkaController)
[2019-12-05 17:36:05,503] INFO [Controller id=3] No more partitions need to be reassigned. Deleting zk path /admin/reassign_partitions (kafka.controller.KafkaController)
[2019-12-05 17:36:05,508] INFO [Controller id=3] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,509] INFO [Controller id=3] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,509] INFO [Controller id=3] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,510] INFO [Controller id=3] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,511] INFO [Controller id=3] Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2019-12-05 17:36:05,636] INFO [Controller id=3] Starting the controller scheduler (kafka.controller.KafkaController)
[2019-12-05 17:36:10,638] INFO [Controller id=3] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2019-12-05 17:36:10,638] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-12-05 17:36:10,640] DEBUG [Controller id=3] Preferred replicas by broker Map() (kafka.controller.KafkaController)
[2019-12-05 17:39:09,403] INFO [Controller id=3] New topics: [Set(demo)], deleted topics: [Set()], new partition replica assignment [Map(demo-23 -> Vector(2, 1, 3), demo-42 -> Vector(3, 1, 2), demo-28 -> Vector(1, 3, 2), demo-39 -> Vector(3, 2, 1), demo-5 -> Vector(2, 1, 3), demo-44 -> Vector(2, 3, 1), demo-14 -> Vector(2, 3, 1), demo-26 -> Vector(2, 3, 1), demo-27 -> Vector(3, 2, 1), demo-8 -> Vector(2, 3, 1), demo-43 -> Vector(1, 2, 3), demo-48 -> Vector(3, 1, 2), demo-33 -> Vector(3, 2, 1), demo-31 -> Vector(1, 2, 3), demo-3 -> Vector(3, 2, 1), demo-13 -> Vector(1, 2, 3), demo-4 -> Vector(1, 3, 2), demo-47 -> Vector(2, 1, 3), demo-16 -> Vector(1, 3, 2), demo-38 -> Vector(2, 3, 1), demo-0 -> Vector(3, 1, 2), demo-9 -> Vector(3, 2, 1), demo-22 -> Vector(1, 3, 2), demo-12 -> Vector(3, 1, 2), demo-21 -> Vector(3, 2, 1), demo-46 -> Vector(1, 3, 2), demo-1 -> Vector(1, 2, 3), demo-17 -> Vector(2, 1, 3), demo-24 -> Vector(3, 1, 2), demo-10 -> Vector(1, 3, 2), demo-37 -> Vector(1, 2, 3), demo-7 -> Vector(1, 2, 3), demo-30 -> Vector(3, 1, 2), demo-34 -> Vector(1, 3, 2), demo-20 -> Vector(2, 3, 1), demo-29 -> Vector(2, 1, 3), demo-36 -> Vector(3, 1, 2), demo-6 -> Vector(3, 1, 2), demo-11 -> Vector(2, 1, 3), demo-41 -> Vector(2, 1, 3), demo-19 -> Vector(1, 2, 3), demo-35 -> Vector(2, 1, 3), demo-32 -> Vector(2, 3, 1), demo-40 -> Vector(1, 3, 2), demo-25 -> Vector(1, 2, 3), demo-18 -> Vector(3, 1, 2), demo-49 -> Vector(1, 2, 3), demo-45 -> Vector(3, 2, 1), demo-2 -> Vector(2, 3, 1), demo-15 -> Vector(3, 2, 1))] (kafka.controller.KafkaController)
[2019-12-05 17:39:09,432] INFO [Controller id=3] New partition creation callback for demo-23,demo-42,demo-28,demo-39,demo-5,demo-44,demo-14,demo-26,demo-27,demo-8,demo-43,demo-48,demo-33,demo-31,demo-3,demo-13,demo-4,demo-47,demo-16,demo-38,demo-0,demo-9,demo-22,demo-12,demo-21,demo-46,demo-1,demo-17,demo-24,demo-10,demo-37,demo-7,demo-30,demo-34,demo-20,demo-29,demo-36,demo-6,demo-11,demo-41,demo-19,demo-35,demo-32,demo-40,demo-25,demo-18,demo-49,demo-45,demo-2,demo-15 (kafka.controller.KafkaController)
[2019-12-05 17:41:10,641] INFO [Controller id=3] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2019-12-05 17:41:10,660] TRACE [Controller id=3] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2019-12-05 17:41:10,664] DEBUG [Controller id=3] Preferred replicas by broker Map(2 -> Map(demo-23 -> Vector(2, 1, 3), demo-5 -> Vector(2, 1, 3), demo-44 -> Vector(2, 3, 1), demo-14 -> Vector(2, 3, 1), demo-26 -> Vector(2, 3, 1), demo-8 -> Vector(2, 3, 1), demo-47 -> Vector(2, 1, 3), demo-38 -> Vector(2, 3, 1), demo-17 -> Vector(2, 1, 3), demo-20 -> Vector(2, 3, 1), demo-29 -> Vector(2, 1, 3), demo-11 -> Vector(2, 1, 3), demo-41 -> Vector(2, 1, 3), demo-35 -> Vector(2, 1, 3), demo-32 -> Vector(2, 3, 1), demo-2 -> Vector(2, 3, 1)), 1 -> Map(demo-28 -> Vector(1, 3, 2), demo-43 -> Vector(1, 2, 3), demo-31 -> Vector(1, 2, 3), demo-13 -> Vector(1, 2, 3), demo-4 -> Vector(1, 3, 2), demo-16 -> Vector(1, 3, 2), demo-22 -> Vector(1, 3, 2), demo-46 -> Vector(1, 3, 2), demo-1 -> Vector(1, 2, 3), demo-10 -> Vector(1, 3, 2), demo-37 -> Vector(1, 2, 3), demo-7 -> Vector(1, 2, 3), demo-34 -> Vector(1, 3, 2), demo-19 -> Vector(1, 2, 3), demo-40 -> Vector(1, 3, 2), demo-25 -> Vector(1, 2, 3), demo-49 -> Vector(1, 2, 3)), 3 -> Map(demo-42 -> Vector(3, 1, 2), demo-39 -> Vector(3, 2, 1), demo-27 -> Vector(3, 2, 1), demo-48 -> Vector(3, 1, 2), demo-33 -> Vector(3, 2, 1), demo-3 -> Vector(3, 2, 1), demo-0 -> Vector(3, 1, 2), demo-9 -> Vector(3, 2, 1), demo-12 -> Vector(3, 1, 2), demo-21 -> Vector(3, 2, 1), demo-24 -> Vector(3, 1, 2), demo-30 -> Vector(3, 1, 2), demo-36 -> Vector(3, 1, 2), demo-6 -> Vector(3, 1, 2), demo-18 -> Vector(3, 1, 2), demo-45 -> Vector(3, 2, 1), demo-15 -> Vector(3, 2, 1))) (kafka.controller.KafkaController)
[2019-12-05 17:41:10,666] DEBUG [Controller id=3] Topics not in preferred replica for broker 2 Map() (kafka.controller.KafkaController)
[2019-12-05 17:41:10,667] TRACE [Controller id=3] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2019-12-05 17:41:10,667] DEBUG [Controller id=3] Topics not in preferred replica for broker 1 Map() (kafka.controller.KafkaController)
[2019-12-05 17:41:10,667] TRACE [Controller id=3] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2019-12-05 17:41:10,667] DEBUG [Controller id=3] Topics not in preferred replica for broker 3 Map() (kafka.controller.KafkaController)
[2019-12-05 17:41:10,667] TRACE [Controller id=3] Leader imbalance ratio for broker 3 is 0.0 (kafka.controller.KafkaController)
[2019-12-05 17:42:24,751] INFO [Controller id=3] Shutting down broker 1 (kafka.controller.KafkaController)
[2019-12-05 17:42:24,752] DEBUG [Controller id=3] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2019-12-05 17:42:24,752] DEBUG [Controller id=3] Live brokers: 2,3 (kafka.controller.KafkaController)
[2019-12-05 17:42:25,597] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=demo,Partition=23,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=42,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=39,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=5,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=44,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=14,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=26,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=27,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=8,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=48,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=33,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=3,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=47,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=38,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=0,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=9,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=12,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=21,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=17,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=24,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=30,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=20,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=29,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=36,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=6,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=11,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=41,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=35,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=32,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=18,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=45,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=2,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=15,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2019-12-05 17:42:26,195] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=demo,Partition=2,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=15,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=42,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=0,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=29,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=32,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=44,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=8,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=36,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=48,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=3,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=17,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=38,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=27,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=12,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=35,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=41,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=18,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=6,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=24,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=45,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=21,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=33,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=14,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=5,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=39,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=26,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=20,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=9,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=30,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=47,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=23,Replica=1],false),StopReplicaRequestInfo([Topic=demo,Partition=11,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2019-12-05 17:42:26,197] TRACE [Controller id=3] All leaders = demo-34 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-45 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-15 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-4 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-26 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-37 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-31 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-20 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-42 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-23 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-12 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-1 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-6 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-28 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-39 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-17 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-9 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-3 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-14 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-25 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-47 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-36 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-41 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-22 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-33 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-11 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-0 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-44 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-49 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-38 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-27 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-8 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-19 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-30 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-46 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-35 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-13 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-24 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-16 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-5 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-21 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-43 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-10 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-32 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-2 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-48 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-29 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-40 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2),demo-7 -> (Leader:2,ISR:2,3,LeaderEpoch:1,ControllerEpoch:2),demo-18 -> (Leader:3,ISR:3,2,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2019-12-05 17:42:26,272] INFO [Controller id=3] Shutting down broker 2 (kafka.controller.KafkaController)
[2019-12-05 17:42:26,273] DEBUG [Controller id=3] All shutting down brokers: 1,2 (kafka.controller.KafkaController)
[2019-12-05 17:42:26,274] DEBUG [Controller id=3] Live brokers: 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:27,496] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=demo,Partition=42,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=28,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=39,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=27,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=48,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=33,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=3,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=4,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=16,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=0,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=9,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=22,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=12,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=21,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=46,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=24,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=10,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=30,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=34,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=36,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=6,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=40,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=18,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=45,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=15,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2019-12-05 17:42:27,617] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:27,718] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:27,782] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=demo,Partition=42,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=3,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=4,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=15,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=33,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=24,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=34,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=28,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=12,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=21,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=40,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=36,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=46,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=10,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=39,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=30,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=18,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=22,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=9,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=16,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=48,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=6,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=45,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=27,Replica=2],false),StopReplicaRequestInfo([Topic=demo,Partition=0,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2019-12-05 17:42:27,786] TRACE [Controller id=3] All leaders = demo-34 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-45 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-15 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-4 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-26 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-37 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-31 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-20 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-42 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-23 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-12 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-1 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-6 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-28 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-39 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-17 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-9 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-3 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-14 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-25 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-47 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-36 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-41 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-22 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-33 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-11 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-0 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-44 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-49 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-38 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-27 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-8 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-19 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-30 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-46 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-35 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-13 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-24 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-16 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-5 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-21 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-43 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-10 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-32 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-2 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-48 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-29 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-40 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-7 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-18 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2019-12-05 17:42:27,787] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:27,787] DEBUG [Controller id=3] All shutting down brokers: 1,2,3 (kafka.controller.KafkaController)
[2019-12-05 17:42:27,787] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2019-12-05 17:42:27,820] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:27,841] TRACE [Controller id=3] All leaders = demo-34 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-45 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-15 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-4 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-26 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-37 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-31 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-20 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-42 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-23 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-12 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-1 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-6 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-28 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-39 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-17 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-9 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-3 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-14 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-25 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-47 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-36 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-41 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-22 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-33 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-11 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-0 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-44 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-49 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-38 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-27 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-8 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-19 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-30 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-46 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-35 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-13 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-24 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-16 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-5 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-21 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-43 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-10 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-32 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-2 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-48 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-29 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-40 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-7 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-18 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2019-12-05 17:42:27,867] WARN [RequestSendThread controllerId=3] Controller 3 epoch 2 fails to send request (type=LeaderAndIsRequest, controllerId=3, controllerEpoch=2, brokerEpoch=71, partitionStates={demo-45=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-15=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-26=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-20=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-42=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-23=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-12=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-6=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-39=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-17=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-9=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-3=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-14=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-47=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-36=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-41=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-11=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-33=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-44=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-0=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-27=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-38=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-8=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-30=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-35=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-24=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-5=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-32=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-21=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-2=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-48=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-29=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-18=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false)}, liveLeaders=(vinicius:9092 (id: 2 rack: null), vinicius:9093 (id: 3 rack: null))) to broker vinicius:9092 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:100)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:256)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:27,921] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:27,968] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,022] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,070] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,123] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,175] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,239] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,276] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,340] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,377] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,441] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,479] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,542] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,580] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,643] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9091 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9091 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,680] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,709] INFO [Controller id=3] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 2,3 (kafka.controller.KafkaController)
[2019-12-05 17:42:28,711] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2019-12-05 17:42:28,711] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2019-12-05 17:42:28,711] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2019-12-05 17:42:28,711] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2019-12-05 17:42:28,714] INFO [Controller id=3] Broker failure callback for 1 (kafka.controller.KafkaController)
[2019-12-05 17:42:28,715] INFO [Controller id=3] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2019-12-05 17:42:28,782] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,883] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:28,920] DEBUG [Controller id=3] Unregister BrokerModifications handler for Vector(1) (kafka.controller.KafkaController)
[2019-12-05 17:42:28,922] INFO [Controller id=3] Updated broker epochs cache: Map(2 -> 71, 3 -> 72) (kafka.controller.KafkaController)
[2019-12-05 17:42:28,984] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,085] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,186] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,287] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,389] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,490] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,591] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,692] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,793] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,894] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:29,995] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:30,097] WARN [RequestSendThread controllerId=3] Controller 3's connection to broker vinicius:9092 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to vinicius:9092 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:295)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:249)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:30,098] INFO [Controller id=3] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:30,098] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2019-12-05 17:42:30,099] WARN [RequestSendThread controllerId=3] Controller 3 epoch 2 fails to send request (type=LeaderAndIsRequest, controllerId=3, controllerEpoch=2, brokerEpoch=71, partitionStates={demo-45=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-15=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-26=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-20=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-42=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-23=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-12=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-6=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-39=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-17=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-9=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-3=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-14=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-47=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-36=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-41=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-11=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-33=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-44=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-0=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-27=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-38=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-8=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-30=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-35=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-24=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-5=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-32=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-21=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,2,1, isNew=false), demo-2=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,3,1, isNew=false), demo-48=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false), demo-29=PartitionState(controllerEpoch=2, leader=2, leaderEpoch=1, isr=2,3, zkVersion=1, replicas=2,1,3, isNew=false), demo-18=PartitionState(controllerEpoch=2, leader=3, leaderEpoch=1, isr=3,2, zkVersion=1, replicas=3,1,2, isNew=false)}, liveLeaders=(vinicius:9092 (id: 2 rack: null), vinicius:9093 (id: 3 rack: null))) to broker vinicius:9092 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1369)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:278)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:75)
	at kafka.controller.RequestSendThread.backoff$1(ControllerChannelManager.scala:237)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:251)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:89)
[2019-12-05 17:42:30,151] TRACE [RequestSendThread controllerId=3] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2019-12-05 17:42:30,151] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2019-12-05 17:42:30,151] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2019-12-05 17:42:30,155] INFO [Controller id=3] Broker failure callback for 2 (kafka.controller.KafkaController)
[2019-12-05 17:42:30,155] INFO [Controller id=3] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2019-12-05 17:42:30,244] DEBUG [Controller id=3] Unregister BrokerModifications handler for Vector(2) (kafka.controller.KafkaController)
[2019-12-05 17:42:30,244] INFO [Controller id=3] Updated broker epochs cache: Map(3 -> 72) (kafka.controller.KafkaController)
[2019-12-05 17:42:32,857] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:32,857] DEBUG [Controller id=3] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:32,857] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2019-12-05 17:42:32,880] TRACE [Controller id=3] All leaders = demo-34 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-45 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-15 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-4 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-26 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-37 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-31 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-20 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-42 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-23 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-12 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-1 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-6 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-28 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-39 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-17 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-9 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-3 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-14 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-25 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-47 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-36 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-41 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-22 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-33 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-11 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-0 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-44 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-49 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-38 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-27 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-8 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-19 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-30 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-46 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-35 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-13 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-24 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-16 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-5 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-21 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-43 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-10 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-32 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-2 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-48 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-29 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-40 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-7 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-18 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2019-12-05 17:42:37,886] INFO [Controller id=3] Shutting down broker 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:37,886] DEBUG [Controller id=3] All shutting down brokers: 3 (kafka.controller.KafkaController)
[2019-12-05 17:42:37,886] DEBUG [Controller id=3] Live brokers:  (kafka.controller.KafkaController)
[2019-12-05 17:42:38,034] TRACE [Controller id=3] All leaders = demo-34 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-45 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-15 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-4 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-26 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-37 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-31 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-20 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-42 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-23 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-12 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-1 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-6 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-28 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-39 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-17 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-9 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-3 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-14 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-25 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-47 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-36 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-41 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-22 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-33 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-11 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-0 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-44 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-49 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-38 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-27 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-8 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-19 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-30 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-46 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-35 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-13 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-24 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-16 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-5 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-21 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-43 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-10 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-32 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-2 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-48 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-29 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-40 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-7 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2),demo-18 -> (Leader:3,ISR:3,LeaderEpoch:2,ControllerEpoch:2) (kafka.controller.KafkaController)
[2019-12-05 17:42:44,079] INFO [ControllerEventThread controllerId=3] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-12-05 17:42:44,079] INFO [ControllerEventThread controllerId=3] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-12-05 17:42:44,079] INFO [ControllerEventThread controllerId=3] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2019-12-05 17:42:44,080] DEBUG [Controller id=3] Resigning (kafka.controller.KafkaController)
[2019-12-05 17:42:44,080] DEBUG [Controller id=3] Unregister BrokerModifications handler for Set(3) (kafka.controller.KafkaController)
[2019-12-05 17:42:44,080] INFO [PartitionStateMachine controllerId=3] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2019-12-05 17:42:44,081] INFO [ReplicaStateMachine controllerId=3] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2019-12-05 17:42:44,081] INFO [RequestSendThread controllerId=3] Shutting down (kafka.controller.RequestSendThread)
[2019-12-05 17:42:44,081] INFO [RequestSendThread controllerId=3] Stopped (kafka.controller.RequestSendThread)
[2019-12-05 17:42:44,081] INFO [RequestSendThread controllerId=3] Shutdown completed (kafka.controller.RequestSendThread)
[2019-12-05 17:42:44,082] INFO [Controller id=3] Resigned (kafka.controller.KafkaController)
